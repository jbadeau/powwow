<?xml version="1.0" encoding="UTF-8"?>
<!--
      <div id="importSearch" dojoType="dijit.form.DropDownButton" showLabel="false"
        iconClass="nomadToolbarIcon nomadIconImport">
       <span>Import Search Terms</span>
       <div id="termsMenu" dojoType="dijit.Menu">
         <div id="mystuff" dojoType="dijit.MenuItem" label="My Stuff"
              onclick="retrieveMyStuff"></div>
         <div id="mostrecent" dojoType="dijit.MenuItem" label="Most Recent"
              onclick="retrieveMostRecent"></div>
         <div id="highestrated" dojoType="dijit.MenuItem" label="Highest Rated"
              onclick="retrieveHighestRated"></div>
         <div id="oftenbookmarked" dojoType="dijit.MenuItem" label="Most Often Bookmarked"
              onclick="retrieveOftenBookmarked"></div>
         <div id="mystuff" dojoType="dijit.MenuItem" label="Mashup Widgets"
              onclick="retrieveMyStuff"></div>
       </div></div>
-->
<widget name="Editor" id="http://openajax.org/samples/widgets/Editor"
		spec="1.0" width='700' height='450'
		xmlns="http://openajax.org/metadata">
    <requires>
		<library name="dojo" version="1.3" src="http://ajax.googleapis.com/ajax/libs/dojo/1.3/">
	    	<require type="javascript" src="dojo/dojo.xd.js"/>
		</library>
    </requires>

    <content>
      <![CDATA[
           <SCRIPT>
               function setSource(source) {
                   document.getElementById('__WID__WIDGET').value = source;
               }
               
               function createSpec(elementId, gadgetId, baseUrl) {
                    var item = document.getElementById(elementId);
                    var tryUrl = baseUrl + "tryGadget.php";
                    var bindArgs = {
                        content: { id: gadgetId,
                                   spec: item.value
                                 },
                        handleAs: 'text',
                        url:  tryUrl,
                        sync: true,
                        load: function (response, request) {
                        },
                        error:  function(error, request) {
                            result = false;
                            alert(error + "\n" + tyrUrl);
                        }
                    };
                    dojo.xhrPost(bindArgs);
               }

              function tryit(textName)
              {
                var item = document.getElementById(textName);
                var d = new Date();
                var t = d.getTime();
                var gid = 'gadget_' + t;
                var loc = document.location.href.toString();
                if ( document.location.search ) {
                    index = loc.indexOf( document.location.search );
                    loc = loc.substr( 0, index + 1 );
                }
                index = loc.lastIndexOf('/');
                var baseUrl = loc.substr(0, index + 1);
                baseUrl = baseUrl.replace(/nomad\/editor\//, "");
                createSpec(textName, gid, baseUrl);
                var specUrl = baseUrl + "OpenAjaxGadget/" + gid + ".xml";
		    	var mm = (typeof mashupMaker !== 'undefined') ? mashupMaker : window.parent.mashupMaker;
                mm.createGadget(specUrl, null, gid);
              }
           </SCRIPT>
           <TABLE STYLE="width:100%;height:100%;">
           <TR HEIGHT="95%">
             <TD>
               <TEXTAREA ID="__WID__WIDGET" ROWS="25" COLS="80" STYLE="overflow:auto;width:100%;height:100%">
<widget name="TryIt" id="http://openajax.org/samples/widgets/TryIt"
		spec="0.1b"
		xmlns="http://openajax.org/metadata">

    <content type="fragment">
      &lt;![CDATA[
       Your Widget Here
       ]]&gt;
    </content>
</widget>
               </TEXTAREA>
             </TD>
           </TR>
           <TR>
             <TD>
               <CENTER><INPUT ID="__WID__TRY" TYPE="BUTTON" VALUE="Try It!" onClick="tryit('__WID__WIDGET')"/></CENTER>
             </TD>
           </TR>
           </TABLE>
      ]]>      
    </content>
</widget>
